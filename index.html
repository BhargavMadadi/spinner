<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AKD Â· Bhangra Show Order</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:     #0b0b1f;
    --bg2:    #12122e;
    --bg3:    #1a1a40;
    --purple: #5b4fcf;
    --purple2:#7c6fe0;
    --border: rgba(255,255,255,0.08);
    --gold:   #f5c518;
    --orange: #ff6b1a;
    --text:   #f0edf8;
    --muted:  #8888aa;
  }
  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 36px 20px 56px;
  }

  /* HEADER */
  .page-header { text-align:center; margin-bottom:28px; }
  .event-label {
    font-size:11px; letter-spacing:4px; text-transform:uppercase;
    color:var(--muted); margin-bottom:6px;
  }
  .page-header h1 {
    font-family:'Bebas Neue',sans-serif;
    font-size:clamp(38px,7vw,68px);
    letter-spacing:5px;
    background:linear-gradient(135deg,var(--purple2),var(--gold));
    -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
    line-height:1;
  }
  .page-header p { color:var(--muted); font-size:12px; letter-spacing:2px; text-transform:uppercase; margin-top:5px; }

  /* LAYOUT */
  .layout {
    display:flex;
    gap:28px;
    width:100%;
    max-width:980px;
    align-items:flex-start;
    justify-content:center;
  }

  /* WHEEL SECTION */
  .wheel-section {
    display:flex; flex-direction:column; align-items:center; gap:16px;
    flex:1; min-width:0;
  }

  .wheel-wrap {
    position:relative;
    width:min(420px,85vw); height:min(420px,85vw);
  }

  canvas#wheelCanvas {
    width:100%; height:100%;
    cursor:pointer;
    filter:drop-shadow(0 0 24px rgba(92,79,207,0.35));
    transition:filter .3s;
  }
  canvas#wheelCanvas:hover { filter:drop-shadow(0 0 36px rgba(92,79,207,0.55)); }

  /* pointer on right */
  .pointer {
    position:absolute; right:-2px; top:50%;
    transform:translateY(-50%);
    width:0; height:0;
    border-top:14px solid transparent;
    border-bottom:14px solid transparent;
    border-right:30px solid #f5c518;
    filter:drop-shadow(0 0 5px rgba(245,197,24,.6));
    z-index:10;
  }

  .hub {
    position:absolute; top:50%; left:50%;
    transform:translate(-50%,-50%);
    width:48px; height:48px; border-radius:50%;
    background:var(--bg2); border:3px solid var(--purple2);
    z-index:10; display:flex; align-items:center; justify-content:center;
    font-family:'Bebas Neue',sans-serif; font-size:10px; letter-spacing:1px;
    color:var(--purple2); cursor:pointer;
    box-shadow:0 0 16px rgba(124,111,224,.3);
    transition:box-shadow .2s;
  }
  .hub:hover { box-shadow:0 0 26px rgba(124,111,224,.55); }

  .spin-btn {
    background:linear-gradient(135deg,var(--purple),var(--purple2));
    color:#fff; border:none;
    font-family:'Bebas Neue',sans-serif;
    font-size:22px; letter-spacing:4px;
    padding:13px 52px; border-radius:5px; cursor:pointer;
    box-shadow:0 4px 22px rgba(91,79,207,.4);
    transition:transform .15s, box-shadow .15s, opacity .15s;
  }
  .spin-btn:hover { transform:translateY(-2px); box-shadow:0 8px 32px rgba(91,79,207,.6); }
  .spin-btn:active { transform:translateY(0); }
  .spin-btn:disabled { opacity:.4; cursor:not-allowed; transform:none; }

  /* result banner (shows after each spin) */
  .result-banner {
    display:none; align-items:center; gap:12px;
    background:var(--bg3); border:1px solid rgba(124,111,224,.3);
    border-radius:8px; padding:13px 20px;
    width:100%; max-width:420px;
    animation:slideIn .35s ease;
  }
  .result-banner.show { display:flex; }
  .rb-num { font-family:'Bebas Neue',sans-serif; font-size:30px; color:var(--purple2); min-width:28px; }
  .rb-name { font-weight:700; font-size:15px; flex:1; }
  .rb-tag {
    font-size:10px; padding:3px 9px; border-radius:3px;
    border:1px solid rgba(124,111,224,.35); color:var(--purple2);
    letter-spacing:1px; font-weight:600; text-transform:uppercase; white-space:nowrap;
  }

  @keyframes slideIn {
    from { opacity:0; transform:translateY(8px); }
    to   { opacity:1; transform:translateY(0); }
  }

  /* FINAL ORDER â€” shown only after all spins done */
  .final-order-wrap {
    display:none;
    width:100%; max-width:420px;
    flex-direction:column; gap:6px;
  }
  .final-order-wrap.show { display:flex; }
  .fo-header {
    font-family:'Bebas Neue',sans-serif;
    font-size:16px; letter-spacing:3px;
    color:var(--muted); margin-bottom:2px;
    text-transform:uppercase;
  }
  .fo-row {
    display:flex; align-items:center; gap:12px;
    background:var(--bg2); border:1px solid var(--border);
    border-radius:6px; padding:10px 15px;
    animation:slideIn .3s ease;
  }
  .fo-num { font-family:'Bebas Neue',sans-serif; font-size:24px; color:var(--purple2); min-width:24px; }
  .fo-name { font-weight:600; font-size:13px; flex:1; }
  .fo-badge {
    font-size:10px; padding:2px 8px; border-radius:3px;
    background:rgba(124,111,224,.15); border:1px solid rgba(124,111,224,.35);
    color:var(--purple2); letter-spacing:1px; font-weight:600; text-transform:uppercase;
  }

  /* SIDEBAR */
  .sidebar {
    width:255px; flex-shrink:0;
    display:flex; flex-direction:column; gap:14px;
  }

  .card {
    background:var(--bg2); border:1px solid var(--border);
    border-radius:10px; padding:16px;
  }
  .card h3 {
    font-family:'Bebas Neue',sans-serif; font-size:16px;
    letter-spacing:2px; color:var(--muted);
    text-transform:uppercase; margin-bottom:10px;
  }

  .team-list { display:flex; flex-direction:column; gap:5px; }
  .team-item {
    display:flex; align-items:center; gap:8px;
    padding:7px 11px; border-radius:6px;
    background:var(--bg3); border:1px solid var(--border);
    font-size:12px; font-weight:500;
    transition:border-color .2s, opacity .2s;
  }
  .team-item.done { opacity:.35; text-decoration:line-through; }
  .team-item.next { border-color:rgba(124,111,224,.5); background:rgba(124,111,224,.08); }
  .team-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
  .remove-btn {
    margin-left:auto; background:none; border:none;
    color:var(--muted); cursor:pointer; font-size:12px;
    transition:color .2s; line-height:1; padding:0 2px;
  }
  .remove-btn:hover { color:#e07070; }

  .add-team-row { display:flex; gap:6px; margin-top:10px; }
  .add-team-row input {
    flex:1; background:var(--bg3); border:1px solid var(--border);
    border-radius:4px; color:var(--text);
    font-family:'Poppins',sans-serif; font-size:12px;
    padding:7px 10px; outline:none; transition:border-color .2s;
  }
  .add-team-row input:focus { border-color:rgba(124,111,224,.45); }
  .add-team-row input::placeholder { color:var(--muted); }
  .add-btn {
    background:var(--bg3); border:1px solid rgba(124,111,224,.35);
    color:var(--purple2); border-radius:4px; width:32px;
    cursor:pointer; font-size:18px;
    display:flex; align-items:center; justify-content:center;
    transition:background .2s;
  }
  .add-btn:hover { background:rgba(124,111,224,.12); }

  .spin-counter { text-align:center; font-size:12px; color:var(--muted); letter-spacing:1px; }
  .spin-counter span { color:var(--purple2); font-weight:700; }

  /* sparkles */
  .sparkle {
    position:fixed; pointer-events:none; z-index:999;
    animation:sparkleFall 1.3s ease-out forwards; font-size:16px;
  }
  @keyframes sparkleFall {
    0%   { transform:translateY(0) rotate(0deg); opacity:1; }
    100% { transform:translateY(240px) rotate(400deg); opacity:0; }
  }

  @media(max-width:680px) {
    .layout { flex-direction:column; align-items:center; }
    .sidebar { width:100%; max-width:420px; }
  }
</style>
</head>
<body>

<div class="page-header">
  <div class="event-label">AAJ KA DHAMAKA Â· March 7, 2026</div>
  <h1>BHANGRA SHOW ORDER</h1>
  <p>Performance Lineup Randomizer</p>
</div>

<div class="layout">

  <!-- WHEEL -->
  <div class="wheel-section">
    <div class="wheel-wrap">
      <canvas id="wheelCanvas" width="500" height="500"></canvas>
      <div class="pointer"></div>
      <div class="hub" onclick="doSpin()">SPIN</div>
    </div>

    <button class="spin-btn" id="spinBtn" onclick="doSpin()">SPIN THE WHEEL</button>

    <div class="result-banner" id="resultBanner">
      <div class="rb-num"  id="rbNum"></div>
      <div class="rb-name" id="rbName"></div>
      <div class="rb-tag"  id="rbTag"></div>
    </div>

    <!-- Final full order â€” only shown after all teams spun -->
    <div class="final-order-wrap" id="finalOrderWrap">
      <div class="fo-header">âœ¦ &nbsp;Full Show Order</div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="card">
      <h3>Teams</h3>
      <div class="team-list" id="teamList"></div>
      <div class="add-team-row">
        <input type="text" id="newTeamInput" placeholder="Add a teamâ€¦" maxlength="40"
               onkeydown="if(event.key==='Enter') addTeam()">
        <button class="add-btn" onclick="addTeam()">+</button>
      </div>
    </div>
    <div class="card">
      <div class="spin-counter">
        Revealed <span id="spinsDone">0</span> of <span id="spinsTotal">0</span>
      </div>
    </div>
  </div>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LOCKED_LAST = "Lok Naach"; // always last â€” do not change

let teams = [
  "Stanford Bhangra",
  "Classic City Bhangra",
  "Mehfil Mitraan Di Bhangra",
  "Lok Naach",
  "Birmingham's Blazin' Bhangra",
];

// Slice colors â€” purples/navies matching AKD palette
const COLORS = [
  "#2d1f7a","#1e1660","#3b2e9e","#16113d",
  "#251a7c","#120e4a","#332590","#1a1250",
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let spinOrder   = [];
let currentSpin = 0;
let spinning    = false;
let angle       = 0;
let fullResults = []; // accumulate for final list

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SHUFFLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length-1; i > 0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BUILD RIGGED ORDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildOrder() {
  const others = teams.filter(t => t !== LOCKED_LAST);
  const rand   = shuffle(others);
  spinOrder    = teams.includes(LOCKED_LAST) ? [...rand, LOCKED_LAST] : rand;
  currentSpin  = 0;
  fullResults  = [];
  angle        = 0;

  document.getElementById('resultBanner').classList.remove('show');
  const fw = document.getElementById('finalOrderWrap');
  // keep header, remove rows
  while (fw.children.length > 1) fw.removeChild(fw.lastChild);
  fw.classList.remove('show');

  document.getElementById('spinBtn').textContent = 'SPIN THE WHEEL';
  document.getElementById('spinBtn').disabled = false;
  updateCounter();
  renderTeamList();
  drawWheel();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CANVAS DRAW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('wheelCanvas');
const ctx    = canvas.getContext('2d');
const CX = canvas.width  / 2;
const CY = canvas.height / 2;
const R  = canvas.width  / 2 - 12;

function drawWheel(highlightIdx = -1) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const remaining = spinOrder.slice(currentSpin);
  const n = remaining.length;
  if (n === 0) return;

  const slice = (2 * Math.PI) / n;

  // outer ring
  ctx.beginPath();
  ctx.arc(CX, CY, R + 6, 0, 2*Math.PI);
  ctx.strokeStyle = 'rgba(124,111,224,0.45)';
  ctx.lineWidth = 3;
  ctx.stroke();

  for (let i = 0; i < n; i++) {
    const start = angle + i * slice;
    const end   = start + slice;
    const isHL  = (i === highlightIdx);

    // slice
    ctx.beginPath();
    ctx.moveTo(CX, CY);
    ctx.arc(CX, CY, R, start, end);
    ctx.closePath();
    ctx.fillStyle = isHL ? '#7c6fe0' : COLORS[i % COLORS.length];
    ctx.fill();

    // border
    ctx.strokeStyle = 'rgba(255,255,255,0.08)';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // label
    ctx.save();
    ctx.translate(CX, CY);
    ctx.rotate(start + slice / 2);
    ctx.textAlign = 'right';
    const fs = Math.max(10, Math.min(16, Math.floor(R * 0.12)));
    ctx.font = `700 ${fs}px Poppins, sans-serif`;
    ctx.fillStyle = '#ffffff';
    ctx.shadowColor = 'rgba(0,0,0,0.85)';
    ctx.shadowBlur  = 5;

    let label = remaining[i];
    const maxW = R * 0.72;
    while (ctx.measureText(label).width > maxW && label.length > 2)
      label = label.slice(0, -1);
    if (label !== remaining[i]) label += 'â€¦';

    ctx.fillText(label, R - 14, fs / 3);
    ctx.restore();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SPIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doSpin() {
  if (spinning) return;
  if (currentSpin >= spinOrder.length) { buildOrder(); return; }

  spinning = true;
  document.getElementById('spinBtn').disabled = true;
  document.getElementById('resultBanner').classList.remove('show');

  const remaining = spinOrder.slice(currentSpin);
  const n         = remaining.length;
  const target    = spinOrder[currentSpin];
  const targetIdx = remaining.indexOf(target);

  const slice = (2 * Math.PI) / n;
  // pointer is on the RIGHT (east, angle=0). We want target slice middle â†’ angle=0
  const targetAngle = -(targetIdx * slice + slice / 2);
  let needed = ((targetAngle - angle) % (2*Math.PI) + 2*Math.PI) % (2*Math.PI);

  const extraSpins = (5 + Math.floor(Math.random()*4)) * 2 * Math.PI;
  const total      = extraSpins + needed;
  const startAngle = angle;
  const duration   = 3400 + Math.random() * 1000;
  const t0         = performance.now();

  function ease(t) { return 1 - Math.pow(1-t, 4); }

  (function tick(now) {
    const t = Math.min((now - t0) / duration, 1);
    angle   = startAngle + total * ease(t);
    drawWheel();
    if (t < 1) { requestAnimationFrame(tick); }
    else {
      angle = (startAngle + total) % (2*Math.PI);
      drawWheel(targetIdx);
      setTimeout(() => onComplete(target), 350);
    }
  })(t0);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ON COMPLETE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function onComplete(team) {
  spinning = false;
  currentSpin++;

  const pos    = currentSpin;
  const isLast = currentSpin === spinOrder.length;
  fullResults.push({ pos, team, isLast });

  // banner
  document.getElementById('rbNum').textContent  = pos;
  document.getElementById('rbName').textContent = team;
  document.getElementById('rbTag').textContent  = isLast ? 'ğŸ‰ Closing Act' : `#${pos} of ${spinOrder.length}`;
  document.getElementById('resultBanner').classList.add('show');

  updateCounter();
  renderTeamList();
  spawnSparkles();

  setTimeout(() => {
    drawWheel();
    const btn = document.getElementById('spinBtn');
    btn.disabled = false;

    if (isLast) {
      btn.textContent = 'RESET & GO AGAIN';
      showFinalOrder();
    } else {
      btn.textContent = 'SPIN THE WHEEL';
    }
  }, 500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FINAL ORDER LIST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showFinalOrder() {
  const wrap = document.getElementById('finalOrderWrap');
  // clear old rows (keep header)
  while (wrap.children.length > 1) wrap.removeChild(wrap.lastChild);

  fullResults.forEach(({ pos, team, isLast }) => {
    const row = document.createElement('div');
    row.className = 'fo-row';
    row.style.animationDelay = `${(pos-1)*80}ms`;
    row.innerHTML = `
      <div class="fo-num">${pos}</div>
      <div class="fo-name">${team}</div>
      ${isLast ? '<div class="fo-badge">Closing Act</div>' : ''}
    `;
    wrap.appendChild(row);
  });

  wrap.classList.add('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTeamList() {
  const el = document.getElementById('teamList');
  el.innerHTML = '';
  teams.forEach(t => {
    const idx  = spinOrder.indexOf(t);
    const done = idx !== -1 && idx < currentSpin;
    const next = idx === currentSpin;
    const item = document.createElement('div');
    item.className = 'team-item' + (done ? ' done' : '') + (next ? ' next' : '');
    item.innerHTML = `
      <div class="team-dot" style="background:${done ? '#555' : '#7c6fe0'}"></div>
      <span style="flex:1">${t}</span>
      <button class="remove-btn" onclick="removeTeam(${JSON.stringify(t)})">âœ•</button>
    `;
    el.appendChild(item);
  });
}

function addTeam() {
  const inp  = document.getElementById('newTeamInput');
  const name = inp.value.trim();
  if (!name || teams.includes(name)) return;
  teams.push(name);
  inp.value = '';
  buildOrder();
}

function removeTeam(name) {
  if (teams.length <= 2) return;
  teams = teams.filter(t => t !== name);
  buildOrder();
}

function updateCounter() {
  document.getElementById('spinsDone').textContent  = currentSpin;
  document.getElementById('spinsTotal').textContent = spinOrder.length;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SPARKLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function spawnSparkles() {
  const e = ['âœ¦','â˜…','âœ§','â—†','ğŸ”¥','âš¡','âœ¨'];
  for (let i = 0; i < 18; i++) {
    setTimeout(() => {
      const s = document.createElement('div');
      s.className   = 'sparkle';
      s.textContent = e[Math.floor(Math.random()*e.length)];
      s.style.left  = Math.random()*100+'vw';
      s.style.top   = Math.random()*70+'px';
      document.body.appendChild(s);
      setTimeout(() => s.remove(), 1400);
    }, i * 55);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
buildOrder();
canvas.addEventListener('click', doSpin);
</script>
</body>
</html>
