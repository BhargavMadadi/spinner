<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AKD · Bhangra Show Order</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
  :root {
    --space-1: #060216;
    --ink:     #f9f8ff;
    --muted:   #c7c6ff;
    --accent:  #72ff9b;
    --accent-2:#7b3cff;
    --border:  rgba(255,255,255,0.14);
    --panel:   linear-gradient(145deg,rgba(12,5,46,.95),rgba(19,10,56,.97));
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    font-family: "Inter", system-ui, sans-serif;
    color: var(--ink);
    background:
      radial-gradient(1200px 800px at 80% -10%, #2a1466 0%, transparent 60%),
      radial-gradient(1000px 700px at 10% 110%,  #3a0ca3 0%, transparent 60%),
      var(--space-1);
    min-height: 100vh;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2.4rem 1.2rem 3.6rem;
  }

  /* TITLE */
  .page-title {
    font-family: "Bangers";
    font-size: clamp(2.6rem, 6vw, 4rem);
    letter-spacing: .16em;
    text-transform: uppercase;
    text-align: center;
    margin-bottom: .3rem;
  }
  .event-tag {
    text-align: center;
    color: var(--muted);
    font-size: .8rem;
    letter-spacing: .18em;
    text-transform: uppercase;
    font-weight: 700;
    margin-bottom: 2rem;
  }

  /* LAYOUT */
  .layout {
    display: flex;
    gap: 1.6rem;
    width: 100%;
    max-width: 1060px;
    align-items: flex-start;
    justify-content: center;
  }

  /* WHEEL SECTION */
  .wheel-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.1rem;
    min-width: 0;
  }

  .wheel-wrap {
    position: relative;
    /* bigger — fills available space generously */
    width: min(520px, 90vw);
    height: min(520px, 90vw);
  }

  canvas#wheelCanvas {
    width: 100%; height: 100%;
    cursor: pointer;
    filter: drop-shadow(0 0 32px rgba(123,60,255,.38));
    transition: filter .3s;
  }
  canvas#wheelCanvas:hover {
    filter: drop-shadow(0 0 48px rgba(123,60,255,.58));
  }

  .pointer {
    position: absolute;
    right: -3px; top: 50%;
    transform: translateY(-50%);
    width: 0; height: 0;
    border-top: 15px solid transparent;
    border-bottom: 15px solid transparent;
    border-right: 32px solid var(--accent);
    filter: drop-shadow(0 0 6px rgba(114,255,155,.7));
    z-index: 10;
  }

  .hub {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%,-50%);
    width: 52px; height: 52px; border-radius: 50%;
    background: radial-gradient(circle at top left, rgba(255,255,255,.12), rgba(6,2,22,.96));
    border: 2px solid rgba(255,255,255,.22);
    box-shadow: 0 18px 35px rgba(0,0,0,.55);
    z-index: 10;
    display: flex; align-items: center; justify-content: center;
    font-family: "Bangers"; font-size: 11px; letter-spacing: 1px;
    color: var(--ink); cursor: pointer;
    transition: border-color .2s, box-shadow .2s;
  }
  .hub:hover {
    border-color: rgba(114,255,155,.4);
    box-shadow: 0 0 22px rgba(114,255,155,.25);
  }

  /* SPIN BUTTON */
  .spin-btn {
    display: inline-flex;
    align-items: center; justify-content: center;
    padding: .8rem 2.4rem;
    border-radius: 999px;
    font-family: "Inter"; font-weight: 800; font-size: 1rem;
    border: 1px solid transparent;
    cursor: pointer;
    transition: .12s ease-out;
    background: linear-gradient(135deg, #72ff9b, #7b3cff);
    color: #060215;
    box-shadow: 0 10px 26px rgba(114,255,155,.35), 0 0 60px rgba(123,60,255,.2) inset;
    letter-spacing: .04em;
  }
  .spin-btn:hover { opacity:.9; transform:translateY(-1px); }
  .spin-btn:active { transform:translateY(0); }
  .spin-btn:disabled { opacity:.35; cursor:not-allowed; transform:none; }

  /* RESULT BANNER */
  .result-banner {
    display: none;
    align-items: center; gap: .9rem;
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 1.1rem;
    padding: 1rem 1.5rem;
    box-shadow: 0 18px 40px rgba(0,0,0,.6);
    width: 100%; max-width: 520px;
    animation: slideIn .35s ease;
  }
  .result-banner.show { display: flex; }
  .rb-num {
    font-family: "Bangers"; font-size: 2.2rem; letter-spacing: .08em;
    color: var(--accent); min-width: 30px;
  }
  .rb-name { font-weight: 900; font-size: 1rem; flex: 1; }

  @keyframes slideIn {
    from { opacity:0; transform:translateY(8px); }
    to   { opacity:1; transform:translateY(0); }
  }

  /* FINAL ORDER */
  .final-wrap {
    display: none;
    flex-direction: column; gap: .55rem;
    width: 100%; max-width: 520px;
  }
  .final-wrap.show { display: flex; }
  .final-header {
    font-family: "Bangers"; font-size: 1rem; letter-spacing: .16em;
    text-transform: uppercase; color: var(--muted); margin-bottom: .15rem;
  }
  .fo-row {
    display: flex; align-items: center; gap: .75rem;
    background: radial-gradient(circle at top left, rgba(255,255,255,.08), rgba(6,2,22,.96));
    border: 1px solid var(--border);
    border-radius: .9rem;
    padding: .75rem 1rem;
    box-shadow: 0 18px 35px rgba(0,0,0,.45);
    animation: slideIn .3s ease;
  }
  .fo-num {
    font-family: "Bangers"; font-size: 1.5rem; letter-spacing: .06em;
    color: var(--accent); min-width: 22px;
  }
  .fo-name { font-weight: 800; font-size: .88rem; }

  /* SIDEBAR */
  .sidebar {
    width: 256px; flex-shrink: 0;
    display: flex; flex-direction: column; gap: .9rem;
    padding-top: .2rem;
  }

  .s-card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 1.1rem;
    padding: 1.2rem 1.2rem 1.3rem;
    box-shadow: 0 18px 40px rgba(0,0,0,.6);
  }
  .s-card h3 {
    font-family: "Bangers"; font-size: .92rem; letter-spacing: .16em;
    text-transform: uppercase; color: var(--muted);
    margin-bottom: .75rem;
  }

  .team-list { display: flex; flex-direction: column; gap: .42rem; }

  /* no highlighting at all — just done vs normal */
  .team-item {
    display: flex; align-items: center; gap: .6rem;
    padding: .6rem .85rem;
    border-radius: .9rem;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    box-shadow: 0 16px 34px rgba(0,0,0,.35);
    font-size: .83rem; font-weight: 700;
    transition: opacity .2s;
  }
  .team-item.done {
    opacity: .3;
    text-decoration: line-through;
  }
  .team-dot {
    width: 7px; height: 7px; border-radius: 50%;
    flex-shrink: 0;
    background: var(--accent-2);
  }
  .team-item.done .team-dot { background: rgba(255,255,255,.2); }
  .team-name-text { flex: 1; }
  .remove-btn {
    background: none; border: none; color: rgba(255,255,255,.22);
    cursor: pointer; font-size: .78rem; line-height: 1; padding: 0 1px;
    transition: color .15s;
  }
  .remove-btn:hover { color: rgba(255,255,255,.65); }

  .add-row { display: flex; gap: .45rem; margin-top: .8rem; }
  .add-row input {
    flex: 1;
    background: rgba(0,0,0,.25);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: .9rem;
    color: var(--ink); font-family: "Inter"; font-size: .8rem;
    padding: .52rem .8rem; outline: none;
    transition: border-color .15s;
  }
  .add-row input:focus { border-color: rgba(114,255,155,.28); }
  .add-row input::placeholder { color: var(--muted); }
  .add-btn {
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.14);
    border-radius: .9rem;
    color: var(--ink); cursor: pointer; font-size: 1.1rem;
    width: 34px; display: flex; align-items: center; justify-content: center;
    transition: background .15s;
  }
  .add-btn:hover { background: rgba(255,255,255,.12); }

  .counter {
    text-align: center; font-size: .8rem; font-weight: 700;
    color: var(--muted); letter-spacing: .06em;
  }
  .counter span { color: var(--accent); }

  .reset-link {
    text-align: center; margin-top: .4rem;
  }
  .reset-link button {
    background: none; border: none;
    color: var(--muted); font-family: "Inter"; font-size: .75rem;
    font-weight: 700; cursor: pointer; letter-spacing: .06em;
    text-transform: uppercase;
    text-decoration: underline; text-underline-offset: 3px;
    transition: color .15s;
  }
  .reset-link button:hover { color: var(--ink); }

  /* sparkles */
  .sparkle {
    position: fixed; pointer-events: none; z-index: 999;
    animation: sparkleFall 1.3s ease-out forwards; font-size: 15px;
  }
  @keyframes sparkleFall {
    0%   { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(240px) rotate(400deg); opacity: 0; }
  }

  @media(max-width: 720px) {
    .layout { flex-direction: column; align-items: center; }
    .sidebar { width: 100%; max-width: 520px; }
  }
</style>
</head>
<body>

<h1 class="page-title">Bhangra Show Order</h1>
<p class="event-tag">AAJ KA DHAMAKA · March 7, 2026</p>

<div class="layout">

  <!-- WHEEL -->
  <div class="wheel-section">
    <div class="wheel-wrap">
      <canvas id="wheelCanvas" width="600" height="600"></canvas>
      <div class="pointer"></div>
      <div class="hub" onclick="doSpin()">SPIN</div>
    </div>

    <button class="spin-btn" id="spinBtn" onclick="doSpin()">Spin the Wheel</button>

    <div class="result-banner" id="resultBanner">
      <div class="rb-num" id="rbNum"></div>
      <div class="rb-name" id="rbName"></div>
    </div>

    <div class="final-wrap" id="finalWrap">
      <div class="final-header">✦ &nbsp;Full Show Order</div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="s-card">
      <h3>Teams</h3>
      <div class="team-list" id="teamList"></div>
      <div class="add-row">
        <input type="text" id="newTeamInput" placeholder="Add a team…" maxlength="48"
               onkeydown="if(event.key==='Enter') addTeam()">
        <button class="add-btn" onclick="addTeam()">+</button>
      </div>
    </div>
    <div class="s-card">
      <div class="counter">
        Revealed <span id="spinsDone">0</span> of <span id="spinsTotal">0</span>
      </div>
      <div class="reset-link">
        <button onclick="buildOrder()">Reset</button>
      </div>
    </div>
  </div>

</div>

<script>
// ═══════════════════════════
//  CONFIG
// ═══════════════════════════
const LOCKED_LAST = "Lok Naach";

let teams = [
  "Stanford Bhangra",
  "Classic City Bhangra",
  "Mehfil Mitraan Di Bhangra",
  "Lok Naach",
  "Birmingham's Blazin' Bhangra",
];

const SLICE_COLORS = [
  "#1e0d5e","#14073b","#2a1466","#0b0624",
  "#1a0a4a","#0f0535","#231060","#100530",
];

// ═══════════════════════════
//  STATE
// ═══════════════════════════
let spinOrder   = [];
let currentSpin = 0;
let spinning    = false;
let angle       = 0;
let fullResults = [];

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function buildOrder() {
  const others = teams.filter(t => t !== LOCKED_LAST);
  const rand   = shuffle(others);
  spinOrder    = teams.includes(LOCKED_LAST) ? [...rand, LOCKED_LAST] : rand;
  currentSpin  = 0;
  fullResults  = [];
  angle        = 0;

  document.getElementById('resultBanner').classList.remove('show');
  const fw = document.getElementById('finalWrap');
  while (fw.children.length > 1) fw.removeChild(fw.lastChild);
  fw.classList.remove('show');

  const btn = document.getElementById('spinBtn');
  btn.textContent = 'Spin the Wheel';
  btn.disabled = false;

  updateCounter();
  renderTeamList();
  drawWheel();
}

// ═══════════════════════════
//  CANVAS
// ═══════════════════════════
const canvas = document.getElementById('wheelCanvas');
const ctx    = canvas.getContext('2d');
const CX = canvas.width  / 2;
const CY = canvas.height / 2;
const R  = canvas.width  / 2 - 14;

function lighten(hex, amt) {
  const n = parseInt(hex.slice(1), 16);
  const r = Math.min(255, (n >> 16) + Math.round(amt * 255));
  const g = Math.min(255, ((n >> 8) & 0xff) + Math.round(amt * 255));
  const b = Math.min(255, (n & 0xff) + Math.round(amt * 255));
  return `rgb(${r},${g},${b})`;
}

function drawWheel(highlightIdx = -1) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const remaining = spinOrder.slice(currentSpin);
  const n = remaining.length;
  if (n === 0) return;

  const slice = (2 * Math.PI) / n;

  // outer glow ring
  ctx.beginPath();
  ctx.arc(CX, CY, R + 8, 0, 2 * Math.PI);
  ctx.strokeStyle = 'rgba(123,60,255,0.5)';
  ctx.lineWidth = 3;
  ctx.stroke();

  ctx.beginPath();
  ctx.arc(CX, CY, R + 2, 0, 2 * Math.PI);
  ctx.strokeStyle = 'rgba(255,255,255,0.07)';
  ctx.lineWidth = 1;
  ctx.stroke();

  for (let i = 0; i < n; i++) {
    const start = angle + i * slice;
    const end   = start + slice;
    const isHL  = (i === highlightIdx);

    ctx.beginPath();
    ctx.moveTo(CX, CY);
    ctx.arc(CX, CY, R, start, end);
    ctx.closePath();

    if (isHL) {
      ctx.fillStyle = '#7b3cff';
    } else {
      const gx = CX + Math.cos(start + slice / 2) * R * 0.5;
      const gy = CY + Math.sin(start + slice / 2) * R * 0.5;
      const grad = ctx.createRadialGradient(CX, CY, 0, gx, gy, R * 0.85);
      grad.addColorStop(0, lighten(SLICE_COLORS[i % SLICE_COLORS.length], 0.14));
      grad.addColorStop(1, SLICE_COLORS[i % SLICE_COLORS.length]);
      ctx.fillStyle = grad;
    }
    ctx.fill();

    ctx.strokeStyle = 'rgba(255,255,255,0.09)';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // label
    ctx.save();
    ctx.translate(CX, CY);
    ctx.rotate(start + slice / 2);
    ctx.textAlign = 'right';
    const fs = Math.max(11, Math.min(17, Math.floor(R * 0.115)));
    ctx.font = `800 ${fs}px Inter, sans-serif`;
    ctx.fillStyle = 'rgba(249,248,255,0.93)';
    ctx.shadowColor = 'rgba(0,0,0,0.95)';
    ctx.shadowBlur  = 5;

    let label = remaining[i];
    const maxW = R * 0.68;
    while (ctx.measureText(label).width > maxW && label.length > 2)
      label = label.slice(0, -1);
    if (label !== remaining[i]) label += '…';

    ctx.fillText(label, R - 18, fs / 3);
    ctx.restore();
  }
}

// ═══════════════════════════
//  SPIN
// ═══════════════════════════
function doSpin() {
  if (spinning) return;
  if (currentSpin >= spinOrder.length) { buildOrder(); return; }

  spinning = true;
  document.getElementById('spinBtn').disabled = true;
  document.getElementById('resultBanner').classList.remove('show');

  const remaining = spinOrder.slice(currentSpin);
  const n         = remaining.length;
  const target    = spinOrder[currentSpin];
  const targetIdx = remaining.indexOf(target);

  const slice       = (2 * Math.PI) / n;
  const targetAngle = -(targetIdx * slice + slice / 2);
  let needed = ((targetAngle - angle) % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);

  const extraSpins = (5 + Math.floor(Math.random() * 4)) * 2 * Math.PI;
  const total      = extraSpins + needed;
  const startAngle = angle;
  const duration   = 3500 + Math.random() * 900;
  const t0         = performance.now();

  function ease(t) { return 1 - Math.pow(1 - t, 4); }

  (function tick(now) {
    const t  = Math.min((now - t0) / duration, 1);
    angle    = startAngle + total * ease(t);
    drawWheel();
    if (t < 1) {
      requestAnimationFrame(tick);
    } else {
      angle = (startAngle + total) % (2 * Math.PI);
      drawWheel(targetIdx);
      setTimeout(() => onComplete(target), 350);
    }
  })(t0);
}

function onComplete(team) {
  spinning = false;
  currentSpin++;
  const pos    = currentSpin;
  const isLast = currentSpin === spinOrder.length;
  fullResults.push({ pos, team });

  document.getElementById('rbNum').textContent  = pos;
  document.getElementById('rbName').textContent = team;
  document.getElementById('resultBanner').classList.add('show');

  updateCounter();
  renderTeamList();
  spawnSparkles();

  setTimeout(() => {
    drawWheel();
    const btn = document.getElementById('spinBtn');
    btn.disabled = false;
    btn.textContent = isLast ? 'Reset & Go Again' : 'Spin the Wheel';
    if (isLast) showFinalOrder();
  }, 500);
}

function showFinalOrder() {
  const wrap = document.getElementById('finalWrap');
  while (wrap.children.length > 1) wrap.removeChild(wrap.lastChild);
  fullResults.forEach(({ pos, team }) => {
    const row = document.createElement('div');
    row.className = 'fo-row';
    row.style.animationDelay = `${(pos - 1) * 70}ms`;
    row.innerHTML = `<div class="fo-num">${pos}</div><div class="fo-name">${team}</div>`;
    wrap.appendChild(row);
  });
  wrap.classList.add('show');
}

// ═══════════════════════════
//  SIDEBAR — no "next" hint
// ═══════════════════════════
function renderTeamList() {
  const el = document.getElementById('teamList');
  el.innerHTML = '';
  teams.forEach(t => {
    const idx  = spinOrder.indexOf(t);
    // only mark as done once it's been revealed — never highlight "next"
    const done = idx !== -1 && idx < currentSpin;
    const item = document.createElement('div');
    item.className = 'team-item' + (done ? ' done' : '');
    item.innerHTML = `
      <div class="team-dot"></div>
      <span class="team-name-text">${t}</span>
      <button class="remove-btn" onclick="removeTeam(${JSON.stringify(t)})">✕</button>
    `;
    el.appendChild(item);
  });
}

function addTeam() {
  const inp  = document.getElementById('newTeamInput');
  const name = inp.value.trim();
  if (!name || teams.includes(name)) return;
  teams.push(name);
  inp.value = '';
  buildOrder();
}

function removeTeam(name) {
  if (teams.length <= 2) return;
  teams = teams.filter(t => t !== name);
  buildOrder();
}

function updateCounter() {
  document.getElementById('spinsDone').textContent  = currentSpin;
  document.getElementById('spinsTotal').textContent = spinOrder.length;
}

function spawnSparkles() {
  const e = ['✦','★','✧','◆','✨'];
  for (let i = 0; i < 16; i++) {
    setTimeout(() => {
      const s = document.createElement('div');
      s.className   = 'sparkle';
      s.textContent = e[Math.floor(Math.random() * e.length)];
      s.style.left  = Math.random() * 100 + 'vw';
      s.style.top   = Math.random() * 80 + 'px';
      document.body.appendChild(s);
      setTimeout(() => s.remove(), 1400);
    }, i * 60);
  }
}

buildOrder();
canvas.addEventListener('click', doSpin);
</script>
</body>
</html>
